---
layout: post
title: [译]Oracle 超大数据及表分区指导
categories: [Database, Oracle]
description: Oracle 超大数据及表分区指导
keywords: Oracle, VLDB, 超大数据表, 表分区, Partitioning
---
> [Oracle docs原文地址](https://docs.oracle.com/cd/B28359_01/server.111/b32024/intro.htm)

**目录**

* TOC
{:toc}

# [译]超大数据库及分区指导(Database VLDB and Partitioning Guide)
## 1 Oracle 超大数据库介绍
### 分区的介绍
分区操作允许你将超大的表和索引分解成更小的更易管理的片，我们称之为分区。分区对应用完全透明。SQL查询和DML完全不用修改。DDL可以直接操作单个分区，而不是整个表或索引，以此简化大数据库对象的管理。  

每个表或索引的分区可以必须有相同的逻辑属性，例如列名，数据类型和约束，每个分许允许有独立的物理属性，例如压缩设置、物理存储设置和表空间。  

分区对很多应用都非常有帮助，尤其是处理大量的数据时，OLTP系统可以用来提升管理和易用性。数据仓库系统也可用来提升性能和管理。

分区的优势如下：
* 可以在分区级别加载数据，新建或重建索引，备份还原数据，显著的缩短这些操作的执行时间。
* 提升查询性能。通过分区，可以提升获得数量级的性能优化。
* 减少停机时间。

  分区独立于分区的维护操作，这一特性可以让你并行维护同一个表或索引的不同分区，可以在不受影响的分区上继续执行`SELECT`和DML操作。
* 提升关键任务系统的可靠性。分区可以减少维护窗口、恢复时间和失败影响。
* 优化系统可用性、缩短运行时间。分区的并行执行是集群环境可伸缩的基础。并行执行支持普通查询、DML和DDL。

分区提升了Oracle 数据库数据的访问数据。可以提供数量级的数据访问优化。不需要修改现有应用。

### 超大数据库（VLDB）和分区
对数据库多大算VLDB， 并没有标准。VLDB和小数据库类似，但是管理很有挑战，这些挑战主要提现单表巨大的体量及操作该体量数据的代价上。在小数据库上这些操作都是很想当然的操作。

如下趋势增加了数据库的体积：
* 以前数据系统是独立建设的，企业开始意识到组合这些系统可以方便的跨部门分析，并且可以减少维护成本。数据库和系统的整合是数据库体积增加的主要因素。
* 法律法规强制要求企业数据至少保持最短时间，造成企业需要存储更长周期的数据。
*  企业发展、企业合并、企业收购导致数据量增长。依赖数据库进行日常活动的用户量也显著增长。

分区是操作大数据库的关键特性，数量的增加是大数据库最基本挑战，分区使用“分而治之”的思想管理表和索引，尤其是不断增大的表和索引。分区可以使你在不过度增加管理或硬件资源的前提下，允许您扩展到非常大的数量级同时保持一致的性能表现。

### 分区是信息生命周期管理(ILM, Information Lifecycle Management)的基础
ILM的核心理念为处于不同生命周期的数据分配合适的存储介质：新的、常用的数据分配在快速的高可用的存储层；老的，不常用数据分配在更廉价的，性能比较差的存储层。可以将不常用的老数据压缩打包。

ILM基础操作、打包、清理或删除老数据时，如果使用分区的技术，将有数量级别的提升。

### 每个数据库都可以分区
不知是大数据库需要分许，小数据库也可以从分许中获益。

## 2 分区的概念
分区提升各种应用的性能、可管理性、易用性，减少存储大量数据的成本。分区可以将表、索引、索引组织的表分成更小的片，使数据在更好的间隔上进行管理和访问。Oracle提供了多种分区策略。分区对应用完全透明，避免了潜在的程应用修改需要的金钱和时间成本。
### 分区基础知识
分区操作将表、索引、索引组织的表拆分成更小的，叫做分区的单位。每个分区有自己的名字，可以有自己的存储特性。

从数据库管理的角度来说，分许可以统一或单独管理，这带给数据库管理员管理分区对象的巨大灵活性。从应用的角度看分区表和不分区表没有任何区别，不需要修改SQL查询和DML语句。

下图展示分区表和非分区表差异

![Figure 2-1](/images/Posts/OracleVLDBPartitioning/2-1.gif)

#### 分区键
被分区的表的行被明确的分拆到了单个分区中。分区键由一个或多个列组成，用来决定行应该存在哪个分区中。Oracle自动用分区键来确定对正确的分区进行增删改。
#### 分区表
只要不包含`LONG` `LONG RAW`类型的表都可以被分成百万个分区。

##### 何时应该分区表
  关于分区表的一些建议：
* 单表大于2G时，建议分区。
* 表包含历史数据，新数据添加到最新的分区。典型的例子是只有当前月的数据是需要修改的，其他11个月的数据是只读的。
* 表的数据需要跨不同的存储设备时。

##### 何时应该分区索引
关于分区索引的建议：
* 避免删除数据时重建整个索引。
* 修改部分数据，不影响整体索引。
* 减少索引列单调增长引起的索引倾斜照成的影响。

#### 索引组织表分区
当分区索引组织表时
* 分区字段必须是主键的子集。
* 第二索引可以被分区（包括本地和全局）
* `OVERFLOW`的数据段的分区和表的分区相同。

#### 系统的分区
系统分区实现了应用控制的分区，不需要数据库控制数据的存储。数据库只提供分区的能力，不知道具体的分区信息。所有的层面的分区操作都由应用控制。往系统分区表里插入数据时，如果不显式的指定分区，插入将失败。

系统分区提供了分区的好处，但是需要应用控制具体的分区和存储。

#### 信息生命周期管理和分区
分区在ILM中扮演关键角色，它可以将数据分组（即分区），分散到不同的存储设备上并可以单独管理。

#### LOB 数据和分区
LOB数据也能被分区。当表被分区时，所有的列存放在分区的表空间里，但是LOB字段，存储在它们自己的表空间里。
这种技术非常有用，因为LOB字段和主要数据分开存储存储，当主要数据经常更新，LOB保持稳定时，非常有益。

#### 分区的好处
分区可以提高性能，方便管理，提高可用性。也可以简化常用的管理任务。
分区可以应对很多前沿应用，分区是简历数T大小数据库或高可用系统的关键应用。
##### 分区提高性能
通过限制检查和操作的数据量及可以进行并行处理的数据分布，分区提供很多有关性能的好处。包括：
* 分区修剪
* 分区连接
